
/*! aping-plugin-youtube v0.4.10 (19-12-2015) by Jonathan Hornung */
"use strict";var jjtApingYoutube=angular.module("jtt_aping_youtube",["jtt_youtube"]).directive("apingYoutube",["youtubeFactory","apingYoutubeHelper","apingUtilityHelper",function(a,b,c){return{require:"?aping",restrict:"A",replace:"false",link:function(d,e,f,g){var h=g.getAppSettings(),i=c.parseJsonFromAttributes(f.apingYoutube,b.getThisPlattformString(),h);i.forEach(function(d){var e={model:h.model};"undefined"!=typeof h.getNativeData?e.getNativeData=h.getNativeData:e.getNativeData=!1;var f={key:c.getApiCredentials(b.getThisPlattformString(),"apiKey"),maxResults:d.items||h.items};d.channelId?(f.channelId=d.channelId,d.search&&(f.q=d.search),a.getVideosFromChannelById(f).success(function(a){a&&g.concatToResults(b.getObjectByJsonData(a,e))})):d.search?(f.q=d.search,a.getVideosFromSearchByString(f).success(function(a){a&&g.concatToResults(b.getObjectByJsonData(a,e))})):d.playlistId&&(f.playlistId=d.playlistId,a.getVideosFromPlaylistById(f).success(function(a){a&&g.concatToResults(b.getObjectByJsonData(a,e))}))})}}}]);jjtApingYoutube.service("apingYoutubeHelper",["apingModels","apingTimeHelper","apingUtilityHelper",function(a,b,c){this.getThisPlattformString=function(){return"youtube"},this.getThisPlattformLink=function(){return"https://www.youtube.com/"},this.getYoutubeIdFromUrl=function(a){var b=/^.*(?:(?:youtu\.be\/|v\/|vi\/|u\/\w\/|embed\/)|(?:(?:watch)?\?v(?:i)?=|\&v(?:i)?=))([^#\&\?]*).*/;return a.match(b)[1]||!1},this.getYoutubeImageFromId=function(a,b){switch(b){case"default":case"maxresdefault":case"mqdefault":case"sddefault":return"https://img.youtube.com/vi/"+a+"/"+b+".jpg";case"hqdefault":default:return"https://img.youtube.com/vi/"+a+"/hqdefault.jpg"}},this.getObjectByJsonData=function(a,b){var c=[];if(a){var d=this;a.items&&angular.forEach(a.items,function(a,e){var f;f=b.getNativeData===!0||"true"===b.getNativeData?a:d.getItemByJsonData(a,b.model),f&&c.push(f)})}return c},this.getItemByJsonData=function(a,b){var c={};if(a&&b)switch(b){case"social":c=this.getSocialItemByJsonData(a);break;case"video":c=this.getVideoItemByJsonData(a);break;default:return!1}return c},this.getSocialItemByJsonData=function(c){var d=a.getNew("social","youtube");return $.extend(!0,d,{blog_name:c.snippet.channelTitle||!1,blog_id:c.snippet.channelId||!1,blog_link:this.getThisPlattformLink()+"channel/"+c.snippet.channelId,intern_type:c.id.kind,intern_id:c.id.videoId||c.snippet.resourceId.videoId,timestamp:b.getTimestampFromDateString(c.snippet.publishedAt,1e3,7200)}),d.date_time=new Date(d.timestamp),""!==c.snippet.title&&""!==c.snippet.description?(d.caption=c.snippet.title,d.text=c.snippet.description):""!==c.snippet.title?d.caption=c.snippet.title:d.caption=c.snippet.description,"youtube#video"==c.id.kind?d.type="video":"youtube#playlistItem"==c.kind&&c.snippet.resourceId&&"youtube#video"==c.snippet.resourceId.kind&&(d.type="video",d.position=c.snippet.position),d.img_url=this.getYoutubeImageFromId(d.intern_id),d.post_url=this.getThisPlattformLink()+"watch?v="+d.intern_id,d},this.getVideoItemByJsonData=function(c){var d=a.getNew("video","youtube");return $.extend(!0,d,{blog_name:c.snippet.channelTitle||!1,blog_id:c.snippet.channelId||!1,blog_link:this.getThisPlattformLink()+"channel/"+c.snippet.channelId,intern_type:c.id.kind,intern_id:c.id.videoId||c.snippet.resourceId.videoId,timestamp:b.getTimestampFromDateString(c.snippet.publishedAt,1e3,7200)}),d.date_time=new Date(d.timestamp),""!==c.snippet.title&&""!==c.snippet.description?(d.caption=c.snippet.title,d.text=c.snippet.description):""!==c.snippet.title?d.caption=c.snippet.title:d.caption=c.snippet.description,d.img_url=this.getYoutubeImageFromId(d.intern_id),d.post_url=this.getThisPlattformLink()+"watch?v="+d.intern_id,d.position=c.snippet.position,d.markup='<iframe width="1280" height="720" src="https://www.youtube.com/embed/'+d.intern_id+'?rel=0&amp;showinfo=0" frameborder="0" allowfullscreen></iframe>',d}}]),angular.module("jtt_youtube",[]).factory("youtubeFactory",["$http","youtubeSearchDataService",function(a,b){var c={};return c.getVideosFromChannelById=function(c){var d=b.getNew("videosFromChannelById",c);return a({method:"GET",url:d.url,params:d.object})},c.getVideosFromSearchByString=function(c){var d=b.getNew("videosFromSearchByString",c);return a({method:"GET",url:d.url,params:d.object})},c.getVideosFromPlaylistById=function(c){var d=b.getNew("videosFromPlaylistById",c);return a({method:"GET",url:d.url,params:d.object})},c.getChannelById=function(c){var d=b.getNew("channelById",c);return a({method:"GET",url:d.url,params:d.object})},c}]).service("youtubeSearchDataService",function(){this.getApiBaseUrl=function(a){return"https://content.googleapis.com/youtube/v3/"},this.getNew=function(a,b){var c={object:{},url:""};switch(a){case"videosFromChannelById":c.object={part:"id,snippet",type:"video",channelId:b.channelId,order:b.order||"date",key:b.key,maxResults:b.maxResults||20},b.q&&(c.object.q=b.q),c.url=this.getApiBaseUrl()+"search?",b.nextPageToken&&(c.url+="pageToken="+b.nextPageToken+"&");break;case"videosFromSearchByString":c.object={part:"id,snippet",type:"video",q:b.q,order:b.order||"date",key:b.key,maxResults:b.maxResults||20},c.url=this.getApiBaseUrl()+"search?",b.nextPageToken&&(c.url+="pageToken="+b.nextPageToken+"&");break;case"videosFromPlaylistById":c.object={part:"id,snippet",type:"video",playlistId:b.playlistId,key:b.key,maxResults:b.maxResults||20},c.url=this.getApiBaseUrl()+"playlistItems?",b.nextPageToken&&(c.url+="pageToken="+b.nextPageToken+"&");break;case"channelById":c.object={part:"id,snippet",type:"channel",channelId:b.channelId,key:b.key,maxResults:b.maxResults||1},c.url=this.getApiBaseUrl()+"search?",b.nextPageToken&&(c.url+="pageToken="+b.nextPageToken+"&")}return c}});